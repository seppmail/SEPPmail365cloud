
# SEPPmail365Cloud module version 2.0.0 release info

## Preparation

* smct4.com for new features 
  * SMC provisioned, but no ExO integration
  * 2 custom Transport rules
  * some traffic before
* smct2 - provisioned with 1.3.8
* smct3 - provisioned with 1.3.8
* Chrome Session to smct2
* Chrome Session to smct3
* Chrome Session to smct4

## Maintenance

* Doc-link in init-screen points now to docs.seppmail.com
* Require ExchangeOnlineManagement Version 3.7.0 as minimum
* Require PowerShell 7.4.6 as minimum version

```powershell
import-module seppmail365cloud -verbose
```

## Bugfixes

* The -whatIf parameter in New-SC365Rules now does NOT delete transport rules if SEPPmail.cloud rules exist.
```powershell
New-SC365Setup
New-SC365Setup -whatif
```

* If an M365 Tenant is dehydrated, raise a warning instead of an error. This allows Inline customers to continue installation because the module loads.
  
```powershell
# switch to smct4
Import-module seppmail365cloud
```

* Fake crypto headers like [secure] or [signed OK] being sent inbound, are now matched only against the subject and not subject or body.
==> Show rules JSON

* New-SC365Connectors now checks if transport rules still point to the connector and stops if this is the case.

```powershell
# switch to smct4
New-SC365Connectors
```


## Features

### New-SC365Setup checks if given parameters fit to cloud deployment

There are 2 ways to run this CmdLet:

1. Without any parameters
2. With some or all parameters -routing -region -SEPPmailCloudDomain

### Running New-SC365Setup without parameters

The CmdLet runs Get-SC36Deployment in the background and takes parameters from the output for the mail flow configuration

>!Info: Setups with New-SC365Setup are always __active immediately__

### Running with parameters

```powershell
# Connect to smct1 (should be empty)
New-SC365Setup -SEPPmailCloudDomain 'contoso.at' -region de -routing inline
#would be a full functioning all to run a setup.
```

### New-Feature New-SC365Setup now allows multiple domains in the -SEPPmailCloudComain parameter.

```powershell
#Run without Parameters
New-SC365Setup -SEPPmailCloudDomain 'smct3.com','seppmailcloudtest3.com' -routing parallel -region prv -whatif
```

### New feature - Parameter checking for New-SC365Setup

Now if you i.e. mistype a parameter value or just enter the wrong region, the CmdLet New-SC365Setup will now run Get-SC365DeploymentInfo anyway and compare your manual input with the info detected by the cloud setup. If it differs it will raise warnings/errors.

**Warnings** when:

- the domain is part of the Exo Tenant but not the Default Accepted domain\n

**Errors** when:

- the region is wrong
- the routingtype is wrong
- the domain is not part of the Exo-tenant
- there are transport rules pointing at connectors in -whatif mode

```powershell
#Run without Parameters
New-SC365Setup -verbose -whatif
```

```powershell
# Run with non-default TAD
New-SC365setup -domain seppmailcloudtest1.com -region prv -routing parallel -whatif
```

```powershell
#run with typo in domain
New-SC365setup -domain wrongdomain.com -region prv -routing parallel -whatif
```

```powershell
#run with wrong region
New-SC365setup -domain smct1.com -region de -routing parallel -whatif
```

```powershell
#run with wrong routing mode
New-SC365setup -domain smct1.com -region prv -routing inline -whatif
```

## SEPPmail support-addresses are added, when installing the connectors

on smct1.com:

```Powershell
Get-HostedContentFilterPolicy -Identity default|select-Object -Expandproperty allowedSenders
```

## Added a warning for setups in Inline Mode that inline setups affect all domains

on rconsult.at.

```Powershell
New-SC365Connectors -Routing inline -Region ch
```

## The Update Script

Setup: we use smct1.com as parallel example and smct3.com as inline example.
Both have standard-setups with the module version 1.3.8

```powershell
./scripts/Update-SC365Setup.ps1
```

```powershell
./scripts/Update-SC365Setup.ps1 -noreport
```


# Optional you may define the ExO object names instead of [SC BKP]
./scripts/Update-SC365Setup.ps1 -Backupname 'BestCloudPartnerBkp'


````


## The Report

DEMO

- Progress bar
- New Layout
- Header Shows Report for: "OrgName"
- Data explanaition
- Link to original CmdLet
- Categories show/hide
- Report Info: FilePath and Fullpath Added, JSON BackupPath added
- Copy/CSV/Excel/PDF/Print on tables for all and for single selected lines
- Tables have sort-icons
- Some Default/important values are bold
- Search field right
- Some tables ==> Move columns
- Connectors: SEPPmail Connectors are green
- Too much data unfold the table
- SEPPmail-objects have version number as separate column
- SEPPmail Objects Connectors have a "EfSkipConfig" which checks recommended setup.
- Defender Config - Default objects are bold.
- SMCT1: HContentFP which doesnt fit parallel config is marked RED (MarkAsSpamSPFRecordHardFail)



## Questions and Feedback
