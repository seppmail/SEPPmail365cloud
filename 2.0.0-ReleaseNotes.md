
# SEPPmail365CLoud Modul Version 2.0.0 Release Info

## Preparation

rconsult is unprovisioned
smct1.com is provisioned new

## New-SC365Setup checks if given parameters fit to cloud deployment

There are 2 ways to run this CmdLet:

1. Without any parameter
2. With parameters -routing -region -SEPPmailCloudDomain

### Running New-SC365Setup without parameters

The CmdLet runs Get-SC36Deployment in the background and takes parameters from the output for the mail flow configuration

### Running with parameters

```powershell
New-SC365Setup -SEPPmailCloudDomain 'contoso.at' -region de -routing inline
#would be a full functioning all to run a setup.
```

!Info: If one parameter is missing the CmdLet falls back to getting the deployment info.

### New feature - Parameter checking for New-SC365Setup

Now if you i.e. mistype a parameter value or just enter the wrong region, the CmdLet New-SC365Setup will now run Get-SC465DeploymentInfo anyway and compare your manual input with the info detected by the cloud setup. If it differs it will raise warnings/errors.

**Warnings** when:

- the domain is part of the Exo Tenant but not the Default Accepted domain\n

**Errors** when:

- the region is wrong
- the routingtype is wrong
- the domain is not part of the Exo-tenant
- there are transport rules pointing at connectors in -whatif mode

```powershell  
#Run without Parameters
New-SC365Setup -verbose -whatif
New-SC365setup -domain seppmailcloudtest1.com -region prv -routing parallel -whatif
```

```powershell
#run with typo in domain
New-SC365setup -domain wrongdomain.com -region prv -routing parallel -whatif
```

```powershell
#run with wrong region
New-SC365setup -domain smct1.com -region de -routing parallel -whatif
```

```powershell
#run with wrong routing mode
New-SC365setup -domain smct1.com -region prv -routing inline -whatif
```

## SEPPmail support-addresses are added, when installing the connectors

on smct1.com:

```Powershell
Get-HostedContentFilterPolicy -Identity default|select allowedSenders
```

## Added a warning for setups in Inline Mode that inline setups affect all domains

on rconsult.at.

```Powershell
New-SC365Connectors -Routing inline -Region ch
```

## The Update Script

DEMO

## The Report

DEMO

- Progress bar
- New Layout
- Header Shows Report for: "OrgName"
- Categories show/hide
- Report Info: FilePath and Fullpath Added, JSON BackupPath added
- Copy/CSV/Excel/PDF/Print on tables for all and for single selected lines
- Tables have sort-icons
- Some Default/important values are bold
- Search field right
- Some tables ==> Move columns
- Connectors: SEPPmail Connectors are green
- Too much data unfold the table
- SEPPmail-objects have version number as separate column
- SEPPmail Objects Connectors have a "EfSkipConfig" which checks recommended setup.
- Defender Config - Default objects are bold.
- SMCT1: HContentFP which doesnt fit parallel config is marked RED (MarkAsSpamSPFRecordHardFail)
- 